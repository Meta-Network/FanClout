{"version":3,"sources":["webpack:///./src/views/OAuth.vue?1a91","webpack:///./src/views/OAuth.vue","webpack:///./src/utils/index.js","webpack:///./src/views/OAuth.vue?97c1"],"names":["class","oauthFail","$t","disassembleJWT","token","iss","exp","platform","id","tokenPayload","substring","indexOf","JSON","parse","atob","name","data","mounted","this","oAuthRedirect","methods","$route","query","path","set","setTimeout","redirectToPath","error","console","$router","push","render","__scopeId"],"mappings":"kHAAA,W,8JCCOA,MAAM,c,wEAAX,eAEM,MAFN,EAEM,eADD,EAAAC,UAAY,EAAAC,GAAE,cAAiB,EAAAA,GAAE,sB,qBCajC,SAASC,EAAgBC,GAC9B,IAAKA,EAAO,MAAO,CAAEC,IAAK,KAAMC,IAAK,EAAGC,SAAU,KAAMC,GAAI,MAC5D,IAAIC,EAAeL,EAAMM,UAAUN,EAAMO,QAAQ,KAAO,GAExD,OADAF,EAAeA,EAAaC,UAAU,EAAGD,EAAaE,QAAQ,MACvDC,KAAKC,MAAMC,KAAKL,I,gBDRV,GACbM,KAAM,OACNC,KAFa,WAGX,MAAO,CACLf,WAAW,IAGfgB,QAPa,WAQXC,KAAKC,iBAEPC,QAAS,CACPD,cADO,WACU,WACf,IAAI,MACsBD,KAAKG,OAAOC,MAA5BlB,EADN,EACMA,MAAOmB,EADb,EACaA,KACXnB,GACF,IAAMoB,IAAI,OAAkBpB,GAC5B,IAAMoB,IAAI,OAAuBrB,EAAeC,IAChDqB,YAAW,WACT,EAAKC,eAAeH,KACnB,MAEHL,KAAKjB,WAAY,EAEnB,MAAO0B,GACPT,KAAKjB,WAAY,EACjB2B,QAAQD,MAAMA,KAGlBD,eAlBO,SAkBSH,GACdL,KAAKW,QAAQC,KAAKP,GAAQ,Q,UEnChC,EAAOQ,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"js/chunk-3472b875.16e08efb.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./OAuth.vue?vue&type=style&index=0&id=bb8d283a&lang=less&scoped=true\"","<template>\n  <div class=\"oauth-text\">\n    {{ oauthFail ? $t('oauth-fail') : $t('redirecting') }}\n  </div>\n</template>\n\n<script>\nimport store from 'store2'\nimport { disassembleJWT } from '../utils'\nimport { KEY_ACCESS_TOKEN, KEY_ACCESS_TOKEN_INFO } from '../constants'\n\nexport default {\n  name: 'Home',\n  data () {\n    return {\n      oauthFail: false\n    }\n  },\n  mounted () {\n    this.oAuthRedirect()\n  },\n  methods: {\n    oAuthRedirect () {\n      try {\n        const { token, path } = this.$route.query\n        if (token) {\n          store.set(KEY_ACCESS_TOKEN, token)\n          store.set(KEY_ACCESS_TOKEN_INFO, disassembleJWT(token))\n          setTimeout(() => {\n            this.redirectToPath(path)\n          }, 3000)\n        } else {\n          this.oauthFail = true\n        }\n      } catch (error) {\n        this.oauthFail = true\n        console.error(error)\n      }\n    },\n    redirectToPath (path) {\n      this.$router.push(path || '/')\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.oauth {\n  &-text {\n    font-size: 20px;\n    text-align: center;\n    margin-top: 20px;\n    padding: 0 10px;\n  }\n}\n</style>\n","\n/**\n * @typedef JWTInfo\n * @type {object}\n * @property {(string|null)} iss - 这是签发用户凭证的时候返回的内容，通常可以直接理解为 username，但取决于用户平台不同，这里的值也会相应的有差距\n * @property {(number|null)} exp - 这是过期时间，使用的是 UNIX 时间戳，你可以用 Javascript 的原生类型 Date 来获取内容，比如 `new Date(user.exp)` 就可以知道时间了，但是实际应用中你应该只需要比大小就可以知道是否过期\n * @property {(string|null)} platform - 这是用户登录的时候使用的平台名称，不同的平台会有不同的数据返回，这里我们举例 email\n * @property {(number|null)} id - 这是用户的唯一身份编码，在 Matataki 的用户数据库中，这个是自增值，所以在常规的应用中，你都应该尽量使用这个值来作为参考内容，因为这个值在全部四个值中是唯一不会改变的\n */\n\n/**\n * 解码 JWT 密钥\n * @param {string} token JWT token 字符串\n * @returns {JWTInfo}\n */\nexport function disassembleJWT (token) {\n  if (!token) return { iss: null, exp: 0, platform: null, id: null }\n  let tokenPayload = token.substring(token.indexOf('.') + 1)\n  tokenPayload = tokenPayload.substring(0, tokenPayload.indexOf('.'))\n  return JSON.parse(atob(tokenPayload))\n}\n","import { render } from \"./OAuth.vue?vue&type=template&id=bb8d283a&scoped=true\"\nimport script from \"./OAuth.vue?vue&type=script&lang=js\"\nexport * from \"./OAuth.vue?vue&type=script&lang=js\"\n\nimport \"./OAuth.vue?vue&type=style&index=0&id=bb8d283a&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-bb8d283a\"\n\nexport default script"],"sourceRoot":""}